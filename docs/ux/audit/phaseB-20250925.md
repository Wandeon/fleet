# Phase B UX Audit â€” 2025-09-25

- Playwright capture run: `/opt/fleet/ux-audit/20250924T224033` (chromium + firefox) using `apps/ui/tests/ux/capture.spec.ts`.
- Source specs reviewed: `docs/ux/device-capabilities-matrix.md`, `docs/ux/operator-jobs-and-stories.md`.

## Route Findings

### `/` (Dashboard overview)
- Aggregated tiles surface high-level telemetry but interactive affordances (Audio/Video/Zigbee/Camera modules) defer to per-route views. Buttons such as "Play on both" and device transport controls emit no API calls (`apps/ui/src/lib/modules/AudioModule.svelte:79`).
- Error and empty states rely on mocked fetches (`apiClient.fetchAudio` etc.) instead of live endpoints when `VITE_USE_MOCKS` = 0.

### `/audio`
- **Missing per-story coverage:**
  - *Play a single audio file / multi-device playback / playlist orchestration*: no device multi-select, playlist designer, or job scheduling UI. Buttons `Play on both`, per-device transport controls and volume sliders lack handlers tied to `/audio/{id}/play` or `/audio/{id}/volume` (`AudioModule.svelte:107`).
  - *Library management*: Upload modal simulates progress and never POSTs to backend; no metadata form, tagging, soft delete, or trash bin (`AudioModule.svelte:51-116`).
  - *Sync diagnostics*: no drift metrics, sync status, or `/sync/nudge` integrations.
- **Placeholder indicators:** success toasts/text hard-coded, queue/seek controls absent, playback state relies on mocks.

### `/video`
- Preview is a static `<img>` and does not open a player. Story requirements for live stream preview, recorded timeline scrub, and CEC power/input switches are unmet (`VideoModule.svelte:91`).
- Buttons call `fetch('/api/video/*')` placeholders instead of generated `VideoService` client (`VideoModule.svelte:37-86`). No confirmation, error surfacing, or status polling.

### `/zigbee`
- Table renders mock devices only. Quick actions buttons have no wiring. Pairing wizard uses `/api/zigbee/*` placeholder endpoints and simulates countdown locally (`ZigbeeModule.svelte:44-161`).
- Missing spec deliverables: guided "Add Device" wizard with backend stub, telemetry charts, rules management.

### `/camera`
- Module shows static image + list. No event severity chips, AI detection metadata, or clip preview modal. `View log` button is inert (`CameraModule.svelte:47`).
- No API call to `/camera/:id/preview` on thumbnail click, and event feed lacks pagination/filtering required by stories.

### `/logs`
- Uses pre-fetched mock entries; there is no WebSocket/stream, no polling, no `/logs?level=` API integration (`logs/+page.svelte:12`).
- Filters operate on local array only; export creates client-side Blob instead of hitting audit export endpoint.
- Missing real-time tailing, correlation ID search, pause/resume controls described in "Monitor real-time logs" story.

### `/settings`
- Form fields populate from `onMount` defaults and never persist through API. `saveSettings` simply waits and toggles UI flags (`settings/+page.svelte:18-44`).
- Required features absent: API/proxy settings saved via `/settings` endpoint, device pairing form, token rotation, role management. No read-only role table.

### `/fleet`
- `apiClient.fetchState` still points at legacy `/fleet/state` mock pipeline and exposes only audio devices (`fleet/+page.svelte:11`). No cross-device layout, filter, or incident acknowledgement flow per operator stories.
- Device detail (`/fleet/[id]`) renders static capabilities + actions; action buttons simulate timers rather than calling job APIs (`fleet/[id]/+page.svelte:14-54`). Missing diagnostics, activity history, and scheduler integration.

### `/health`
- `+page.ts` injects `mockHealthData` regardless of backend values (`health/+page.ts:6-40`). Realtime incidents and remediation links not implemented.

## Gap Summary
- All operator jobs outlined for Audio, Video, Zigbee, Camera, Logs, and Settings remain unimplemented or stubbed with local timers/fake fetches.
- Generated OpenAPI client (`apps/ui/src/lib/api/gen`) exposes the required endpoints, but `apiClient` (`apps/ui/src/lib/api/client.ts`) still calls legacy helper names (`getAudioDevices`, `/video`) and never invokes new per-device routes.
- CI Playwright smoke suite already fails because expected mocked events are missing, highlighting drift between UI expectations and data providers.
- Audit artefacts (screenshots + control manifests) saved under `/opt/fleet/ux-audit/20250924T224033` for CEO review.

Next steps: replace mocks with real API wiring, design missing playlist/live-player/CEC/telemetry components, and extend Playwright coverage to validate end-to-end operator jobs before PR submission.
